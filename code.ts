const inputString: string =
  "lorem ipsum dolor sit amet consectetur adipiscing elit vestibulum vitae erat est donec mollis tincidunt lobortis donec bibendum congue felis ut rutrum erat ullamcorper eget sed at elit eleifend maximus metus eu varius ante vivamus posuere urna a sem pellentesque rutrum ut eu tellus a urna consectetur tempus in lacinia sagittis sapien quis viverra purus lobortis non nulla nisl quam venenatis fermentum consequat nec sodales eget augue morbi accumsan ligula quis lobortis fringilla cras mattis turpis vitae nisl viverra sit amet aliquam nisl lacinia integer volutpat nibh vitae dolor accumsan cursus mauris lobortis nisl et dictum laoreet sem massa suscipit ante ac pretium quam metus id magna pellentesque eget justo vel velit eleifend facilisis cras id elit semper magna elementum ultricies sed vitae enim sollicitudin metus fermentum posuere donec vehicula erat at convallis pellentesque nunc justo hendrerit arcu at pellentesque quam purus vitae odio etiam sagittis laoreet pretium in hac habitasse platea dictumst maecenas quam purus aliquam eget justo id pretium gravida dolor phasellus elementum metus non posuere venenatis nulla nec quam imperdiet rhoncus velit et dapibus purus donec ultrices leo a enim scelerisque aliquet sed in lorem elit integer vitae massa egestas eleifend erat vehicula varius ligula aliquam quis mattis quam duis eleifend purus nec vulputate malesuada neque diam lacinia enim eu feugiat metus quam et nisl pellentesque tempor feugiat augue non pulvinar nibh laoreet eu orci varius natoque penatibus et magnis dis parturient montes nascetur ridiculus mus nulla porta arcu ac vulputate suscipit integer rhoncus tempus tortor et gravida est porta sed curabitur lacinia mauris at lacus vulputate a rhoncus felis egestas quisque et turpis non neque interdum vehicula id a tortor proin sed enim metus vivamus lobortis dui a interdum ultrices duis vulputate tellus at efficitur euismod ante tortor tincidunt ante nec tristique nisi massa nec lectus donec at odio nisl cras ac nisl vel lorem mattis finibus nec at odio class aptent taciti sociosqu ad litora torquent per conubia nostra per inceptos himenaeos in euismod hendrerit orci eget porta sapien feugiat ut praesent id ipsum ut lacus laoreet imperdiet aliquam id ipsum ac magna dapibus cursus et vitae lectus pellentesque vestibulum odio id placerat tincidunt nunc convallis velit et dui condimentum quis viverra dui fermentum phasellus eget velit quis magna bibendum sagittis sed in arcu curabitur consequat mattis ornare maecenas quis risus ac sapien scelerisque iaculis in scelerisque urna donec lorem arcu molestie eu nibh nec pulvinar finibus sapien sed luctus enim non accumsan finibus lorem ipsum dolor sit amet consectetur adipiscing elit in ligula mi pharetra eget pellentesque eu sagittis quis neque nullam sed felis pharetra molestie tellus ac vulputate turpis curabitur id congue neque condimentum semper ante vivamus dolor ipsum laoreet at pretium non auctor nec libero vivamus et interdum ex sed commodo diam elit a tristique dolor dignissim nec fusce mauris odio dapibus eu eleifend et ultricies vel turpis phasellus scelerisque risus ac ex auctor dapibus mauris nisi est suscipit sed odio et scelerisque eleifend metus in at neque venenatis hendrerit leo non tempus mi donec iaculis sem sodales urna posuere gravida morbi tellus odio sodales molestie pellentesque eget consectetur eget magna aliquam ut mattis nisi cras et diam dui phasellus non leo et diam dignissim sagittis sed ut ex morbi gravida facilisis finibus proin placerat tristique odio sagittis consequat nulla quis ante convallis porttitor ex ultrices euismod lectus donec feugiat fermentum odio tempor egestas lacus ornare ac quisque in semper enim a consequat neque fusce bibendum erat tortor ut interdum leo sodales eu praesent ac dolor nulla cras vitae volutpat nunc pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas nullam gravida ac lacus dapibus consequat suspendisse rhoncus ante vulputate euismod tempor pellentesque mi ex vulputate non luctus ac consequat sit amet ante quisque sit amet accumsan lacus sit amet sodales ligula quisque at blandit tellus sit amet dapibus ipsum pellentesque sed velit accumsan feugiat sapien eget finibus mi in non massa et risus interdum euismod class aptent taciti sociosqu ad litora torquent per conubia nostra per inceptos himenaeos etiam dapibus maximus massa non mollis ligula lacinia id maecenas efficitur nibh ac massa viverra sollicitudin suspendisse fermentum quam sit amet volutpat elementum curabitur euismod imperdiet hendrerit maecenas varius massa ante ac efficitur ex iaculis id nullam sit amet varius nisi morbi sed neque quis enim accumsan placerat nunc tristique vitae nibh sit amet auctor vivamus quam diam dictum quis turpis eget viverra bibendum neque fusce id risus pharetra dolor eleifend mollis non et ligula suspendisse tincidunt vehicula metus pellentesque molestie dolor sapien sed fringilla metus ullamcorper vitae pellentesque lorem risus semper at purus quis dignissim maximus risus donec sit amet turpis non dolor mattis feugiat curabitur imperdiet quam in risus congue eu volutpat urna tempor fusce id tristique neque vivamus malesuada ullamcorper nisi eu imperdiet vivamus non libero tincidunt metus egestas rhoncus vestibulum libero ex consequat eu eleifend quis facilisis non ante vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae maecenas odio neque ornare pellentesque est non dignissim porttitor ligula nulla placerat lacus sit amet felis dictum varius sed ligula odio tempus sit amet facilisis in fringilla ut magna phasellus quis placerat risus fusce scelerisque auctor velit eget gravida lectus luctus vitae proin at commodo dui cras convallis arcu vitae neque convallis suscipit aenean porttitor quam et lobortis posuere nibh risus vehicula leo sed dictum velit nibh at risus nulla semper faucibus venenatis aenean maximus nibh nec arcu tincidunt vehicula morbi nec odio leo fusce tortor est luctus eu mi ut condimentum ullamcorper felis etiam non ex ornare pellentesque lorem id accumsan turpis pellentesque nec dui tortor phasellus fringilla risus vitae dictum vestibulum nullam vel felis bibendum pretium lacus in vestibulum neque aliquam laoreet rhoncus lectus semper placerat donec a diam non diam imperdiet scelerisque vitae finibus neque ut pharetra leo nec arcu elementum molestie sed ligula urna condimentum vitae volutpat quis egestas non ex aenean luctus arcu in pellentesque porta sapien mi volutpat risus non venenatis nibh lacus ut nulla in iaculis ac ipsum eu semper maecenas tincidunt nisi turpis quis lobortis mauris sodales ut cras ac aliquam tellus sed massa tortor vehicula at ante vel lobortis accumsan quam ut imperdiet est nec consequat scelerisque tellus magna facilisis nibh eu fermentum lectus purus vitae nisi aliquam feugiat leo magna vel auctor purus malesuada eu nunc cursus dolor id viverra volutpat praesent convallis metus a lobortis commodo felis risus tempor arcu quis fermentum ex lacus at quam proin ac mattis nisl cursus egestas urna praesent ornare congue urna ut mollis tellus consequat quis sed purus quam fermentum id rhoncus non mollis at neque in elementum turpis ut elit luctus vel hendrerit arcu mollis nam tincidunt nunc ut nulla vestibulum eu interdum nibh placerat curabitur posuere libero ut porttitor finibus lectus lectus maximus tortor sit amet blandit dolor leo at ante proin tincidunt dolor non tincidunt porta in auctor elementum tortor et sodales etiam at tincidunt ligula duis quis aliquam mauris eget facilisis orci pellentesque aliquam convallis nibh a tempor lorem rutrum id vivamus euismod gravida elit quis aliquet mauris ultricies pulvinar tristique aenean bibendum vel est eget pretium donec eget turpis pulvinar eros sagittis consectetur quis ut erat proin tempor mauris ex id consequat ligula tristique et proin rhoncus vitae augue et hendrerit in ut interdum mauris nunc a justo ac sapien vulputate dictum morbi laoreet elit sed ante accumsan vel egestas eros pharetra nulla ac diam massa fusce ac erat magna pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas pellentesque consectetur sapien nulla vitae pellentesque leo placerat vel aliquam erat volutpat donec cursus neque ac volutpat sollicitudin erat enim accumsan massa et ornare nulla orci sit amet dui etiam tempus venenatis lectus praesent egestas eu orci nec rutrum in ut ipsum ac lacus iaculis auctor quis at eros donec erat nunc ullamcorper facilisis mollis vitae viverra quis mi in nec scelerisque metus posuere fermentum neque duis magna ligula dapibus et ultrices pharetra commodo ac felis ut ac purus aliquam ullamcorper orci ac ultricies elit aenean quis tellus eget sem lacinia consequat at in erat duis at risus felis nulla et lectus ac metus rhoncus varius nec nec ante quisque auctor id felis sit amet tempor vivamus tempor orci id condimentum malesuada morbi viverra tristique aliquam vestibulum non cursus nunc nam sagittis sed lectus sit amet dignissim aenean eleifend arcu id hendrerit fringilla vestibulum scelerisque vestibulum risus vel tincidunt vestibulum purus quam fermentum pulvinar sagittis in varius ultrices nulla aenean sit amet tortor eu erat pharetra dignissim quis eget est praesent varius vehicula metus a egestas augue imperdiet id nulla sed metus leo nulla dictum elit nisl vel venenatis lectus luctus sed nullam ornare accumsan facilisis nam lobortis rhoncus iaculis duis sit amet sem eget erat finibus tempor etiam quis elit sem praesent pharetra odio non malesuada sagittis diam arcu fringilla urna ac rutrum turpis ligula sed arcu aenean porta orci et nisl feugiat sed malesuada ante efficitur ut in ligula aliquam eleifend augue non aliquet leo aliquam erat volutpat phasellus congue lorem nibh maecenas imperdiet purus tellus fusce cursus justo nec est congue quis pulvinar lorem eleifend quisque eu metus ut sem varius molestie condimentum a enim praesent sed lorem ac lacus consectetur laoreet pellentesque ut enim vivamus molestie nulla nec pharetra pulvinar libero ante pharetra nulla et rhoncus metus nunc ac augue aliquam sit amet turpis tincidunt euismod nisi semper tristique ex fusce purus risus dignissim vitae malesuada vitae lobortis eu est fusce a dolor at felis gravida blandit in sed lacus nunc rhoncus odio est in sollicitudin neque tristique et donec quis felis luctus augue ultricies suscipit ac eu quam aliquam non ornare ex aliquam aliquet commodo arcu nec gravida donec quis orci vestibulum massa cursus sollicitudin ut ac convallis arcu id fermentum neque ut bibendum nisi massa vitae iaculis est accumsan in vestibulum accumsan dui in dui tempus scelerisque ut pellentesque malesuada mauris ut tempus cras vehicula viverra cursus donec tempus sit amet dui sit amet iaculis interdum et malesuada fames ac ante ipsum primis in faucibus pellentesque a vulputate enim nulla vulputate tincidunt eros vitae mattis lacus ornare vel proin non tincidunt ligula sit amet pulvinar libero class aptent taciti sociosqu ad litora torquent per conubia nostra per inceptos himenaeos nullam tempus nibh a dui finibus vitae imperdiet mauris tempor etiam bibendum magna sed ex interdum id congue nisl eleifend praesent elit magna aliquet vitae mauris a lacinia hendrerit odio donec lacus justo tempus eget consequat sit amet dictum malesuada metus sed lobortis lectus eget eleifend mattis lacus metus imperdiet tellus in lacinia felis risus ac sem proin ut sapien at eros egestas lobortis fusce diam neque vestibulum facilisis purus non cursus dapibus nisl praesent aliquet leo justo eget varius ipsum posuere at sed pellentesque dui ut ligula feugiat sodales sed sodales libero et enim venenatis mattis praesent id mauris quam mauris accumsan non mauris et tristique sed porta libero nec interdum malesuada nunc condimentum cursus mollis maecenas scelerisque dolor eget risus pretium tempus aenean a urna consectetur rutrum metus eu ultrices ex vestibulum rutrum lorem vel risus faucibus pellentesque pellentesque ac dolor vel metus porta commodo aliquam at dui diam curabitur facilisis ornare sem a iaculis massa ultricies id vestibulum ac sollicitudin tortor maecenas in ligula eget nisl eleifend dignissim sed in nunc sed sit amet est eget ante ultricies ultricies aliquam lacus magna ullamcorper quis diam in placerat cursus nulla vestibulum malesuada porttitor libero id placerat nisl rutrum quis interdum et malesuada fames ac ante ipsum primis in faucibus morbi auctor purus ut risus iaculis ac varius sem ultricies ut venenatis venenatis nunc molestie semper ut augue dolor porta vitae facilisis eget elementum non tortor etiam finibus diam sed elementum bibendum etiam imperdiet molestie venenatis mauris tortor nulla semper at sapien vitae malesuada feugiat metus aenean bibendum convallis orci sed mollis suspendisse aliquet elit est sit amet semper leo blandit non suspendisse vel sapien in quam lobortis volutpat ut congue odio ac enim pulvinar elementum aliquam auctor lacus id est lacinia fringilla praesent pellentesque vestibulum enim eget aliquet duis sem tortor lobortis nec pellentesque hendrerit interdum sed quam curabitur viverra arcu sit amet rhoncus placerat sed id commodo lorem mauris vehicula vitae elit vestibulum convallis phasellus egestas cursus nibh aliquam pretium leo interdum elit hendrerit efficitur sed tincidunt sollicitudin tristique cras sed augue sit amet ante dictum hendrerit aenean aliquam pharetra tortor quis rutrum integer ut iaculis elit maecenas quis enim eget orci varius posuere mauris tempor massa sit amet dictum rhoncus purus eros aliquam sapien eget vestibulum magna tortor et nisl sed dignissim iaculis convallis donec a bibendum nibh sed non turpis tristique sapien fermentum blandit sed tempor magna sit amet ultrices commodo elit nisi sagittis mi id dictum eros nisi sed est fusce in lorem eget lectus consectetur gravida integer consequat a lectus vitae auctor mauris dignissim condimentum tortor eu commodo dolor dignissim sed pellentesque nulla arcu mattis nec dui ultrices commodo vestibulum massa etiam rhoncus mauris viverra tortor interdum eleifend nam sit amet nulla at metus posuere egestas eu scelerisque arcu fusce urna enim egestas ac euismod ac tincidunt sed justo phasellus sed lorem erat in hac habitasse platea dictumst nulla commodo odio eget odio ultricies vel interdum arcu aliquam nulla egestas ante nulla quis commodo erat commodo sit amet nunc leo eros iaculis ut nisi et dignissim sollicitudin risus donec rutrum pellentesque viverra fusce nec lectus vel erat ullamcorper rhoncus duis dapibus eros vel aliquet mattis in hac habitasse platea dictumst quisque vitae est ex phasellus ac lorem sodales ullamcorper dui vitae efficitur augue orci varius natoque penatibus et magnis dis parturient montes nascetur ridiculus mus in hac habitasse platea dictumst duis pretium sapien ut blandit finibus lorem neque viverra lacus pellentesque maximus ex nisi at mi vestibulum tempus vitae mi sed maximus class aptent taciti sociosqu ad litora torquent per conubia nostra per inceptos himenaeos mauris euismod nunc quis pharetra elementum nisl metus sodales nisi a imperdiet urna elit sed diam aenean tincidunt tempor ipsum vitae pretium erat maximus non etiam faucibus eros non elit ullamcorper molestie nam a elementum urna aliquam laoreet quis lectus quis faucibus curabitur neque urna convallis ac pharetra id hendrerit sit amet enim nullam hendrerit pretium magna praesent eleifend velit vel consectetur aliquam etiam elementum ac quam eget pulvinar nulla est urna ullamcorper scelerisque risus in lobortis placerat ante phasellus dapibus nibh in sollicitudin placerat erat nisi laoreet ex ac malesuada arcu eros in urna morbi dictum efficitur sem id consequat etiam sagittis ornare condimentum integer euismod justo eget sem ullamcorper varius sed venenatis metus non ullamcorper eleifend dolor odio pellentesque dolor et venenatis erat tellus tincidunt massa fusce vel ornare nunc sed mattis quam proin dignissim purus nec leo pharetra vehicula pellentesque vel euismod ipsum ut finibus et purus et sollicitudin praesent malesuada in erat at porta aliquam id venenatis ante vivamus et commodo neque donec imperdiet lacus eget quam faucibus eleifend vivamus purus neque interdum nec tincidunt sit amet porttitor eget nunc duis auctor efficitur nisi sed ullamcorper lectus imperdiet eget nam risus massa iaculis ut tellus id lobortis tincidunt erat sed tempor iaculis magna sit amet faucibus nulla interdum sit amet donec fringilla suscipit lectus eget porttitor praesent in augue ex praesent consectetur nulla fermentum imperdiet ornare ipsum turpis dapibus nibh vitae bibendum erat ex eget leo aenean tincidunt commodo iaculis in hac habitasse platea dictumst ut consequat enim ac lectus tempus sed malesuada augue pretium duis porttitor libero arcu eu lacinia leo consectetur vitae integer est neque sagittis in massa non aliquam lacinia turpis suspendisse nunc mauris convallis sit amet justo vel rhoncus bibendum leo aenean tempor facilisis orci vitae euismod nibh aenean eu maximus lectus aliquam sit amet tortor non ex scelerisque lobortis nullam ut vulputate lorem phasellus eget dui laoreet condimentum dui a blandit arcu mauris in scelerisque magna sed vulputate metus curabitur a magna nec lectus fermentum fermentum et sit amet tortor vivamus vulputate ornare erat at tincidunt quisque vitae semper odio a molestie dui maecenas egestas quam ligula in efficitur sem porta eu vivamus id sodales risus quis consequat lorem fusce luctus eros et tellus consectetur at hendrerit nibh gravida etiam eleifend orci ut leo maximus venenatis id nec est nulla malesuada leo ut sollicitudin bibendum donec mollis arcu a ullamcorper semper est ante sagittis ex non finibus dolor purus non massa duis eros velit porta id odio ut tincidunt elementum velit praesent finibus ornare aliquam morbi fermentum elit mi nec sollicitudin mi tempor in fusce non vehicula justo eu dignissim tortor pellentesque venenatis nunc in tortor maximus fringilla sed mi ante mattis id dignissim vitae efficitur eu risus vivamus nec sagittis dolor donec id risus molestie semper sapien ut lacinia diam sed viverra euismod mauris sed ultrices fusce ullamcorper velit nulla vitae tristique lacus suscipit eget nam vehicula lacinia pretium nam porta fringilla nisl quis tincidunt risus pellentesque et donec porta dui consectetur est fermentum viverra fusce quis aliquam magna in egestas auctor nunc ac fermentum etiam quis felis et magna varius interdum varius ac dui praesent dictum elit sed elit mollis suscipit molestie nibh efficitur vestibulum nec suscipit lacus at laoreet metus aenean consectetur id leo vitae semper nullam tempor euismod magna eu lobortis aliquam et arcu id nulla fringilla mattis nec sed tortor aliquam a leo a felis dictum sollicitudin ac et felis praesent metus massa luctus vitae gravida ac placerat vel nunc nam mattis dolor faucibus egestas mauris a ullamcorper diam nam vestibulum nisl ut lacinia pulvinar phasellus ipsum neque facilisis vel pharetra in aliquam vel purus quisque blandit neque non aliquam porttitor magna mi pellentesque sapien nec gravida sem velit id sapien phasellus eu massa efficitur tempor sem at tempor nunc in sit amet velit vestibulum sodales nibh ut mattis libero duis at risus vitae risus ultrices posuere eu ut dui integer accumsan metus urna sit amet pellentesque sapien tincidunt nec nullam dictum euismod suscipit vivamus laoreet tellus vel nisl sollicitudin tincidunt praesent ac tortor eget ex aliquet euismod et vitae augue duis vitae purus id neque mattis rutrum eget ac lectus nulla facilisis ligula sit amet fringilla efficitur in sit amet tincidunt mauris proin convallis libero sed venenatis auctor quisque orci mi mattis a metus porttitor pulvinar cursus lectus in nec imperdiet est phasellus lectus enim sagittis dignissim commodo sed feugiat ut leo maecenas et sagittis arcu morbi luctus vitae lectus id hendrerit donec massa libero sodales a velit a sagittis lacinia nulla nunc sed sem nunc pellentesque eget malesuada eros sed quis neque quis sem feugiat rutrum vitae eu arcu suspendisse posuere auctor nibh eget gravida libero convallis et sed varius ac magna a venenatis donec blandit metus eu turpis interdum dignissim vestibulum imperdiet odio mi nullam at enim enim aliquam erat volutpat sed at tortor pellentesque varius massa vel sollicitudin neque curabitur semper ligula pretium mauris ultrices a fermentum dui aliquet vivamus facilisis feugiat urna a posuere integer eu lectus nisi in hac habitasse platea dictumst suspendisse sagittis venenatis ipsum non scelerisque libero volutpat nec donec non semper ex sed ac turpis mattis vestibulum est non rhoncus metus quisque arcu velit elementum eget auctor a varius ac nibh vivamus quis diam ipsum mauris a ex lorem cras ipsum justo dictum ut risus id accumsan maximus enim quisque ullamcorper varius lacus vel posuere velit mollis a vestibulum tempor pulvinar fringilla maecenas nulla sem fermentum a est at sodales facilisis nulla nam auctor at neque eu tincidunt maecenas in iaculis elit vel bibendum leo donec vitae ante non nibh faucibus pellentesque ac sed lorem curabitur et eleifend nisl nunc vel justo ac ante hendrerit condimentum non id tortor sed et metus a elit tempor lobortis dignissim ut ante in hac habitasse platea dictumst vivamus vel egestas lorem maecenas rutrum iaculis felis semper interdum cras interdum dignissim placerat quisque libero massa cursus vel dignissim sit amet commodo ut nunc lorem ipsum dolor sit amet consectetur adipiscing elit aliquam vel erat ligula vivamus porttitor sed risus non varius in ornare magna aliquam scelerisque aliquam duis et purus nec odio egestas egestas donec vulputate tempus euismod integer nec augue molestie pellentesque libero a aliquet metus cras non tellus imperdiet iaculis nibh vestibulum ornare metus duis commodo tempus orci ut blandit ante nunc eleifend dolor tellus ac efficitur tellus dictum sit amet quisque maximus sem et purus ultrices commodo tincidunt tortor interdum quisque sit amet enim ac turpis eleifend consequat eget eget diam sed ac neque nec nisi consectetur pellentesque quis vel arcu sed felis turpis tincidunt a viverra quis iaculis id ligula integer est elit porttitor quis volutpat ut fringilla sed massa ut non tellus gravida rhoncus dui quis fermentum augue aenean varius non tellus vitae varius donec ac dignissim metus et tincidunt dui suspendisse potenti lorem ipsum dolor sit amet consectetur adipiscing elit morbi lorem odio sodales id leo ac pellentesque porta justo sed ut iaculis augue aenean tincidunt lobortis placerat maecenas fringilla interdum ornare fusce id dignissim dolor at blandit nibh aliquam erat volutpat aenean a porttitor magna nulla sit amet euismod est nullam viverra lectus eget orci varius blandit integer id pharetra urna in vel mi ac magna dignissim placerat morbi sed lectus consectetur blandit risus ut hendrerit velit nunc a dolor eu nulla scelerisque blandit donec commodo faucibus metus nam massa neque dapibus vitae tincidunt eget malesuada quis ipsum praesent faucibus purus odio malesuada posuere velit pulvinar id in ex tellus ultrices eu rhoncus eget luctus id felis morbi pellentesque urna vitae massa porttitor at condimentum mauris accumsan nunc ornare orci ac vestibulum condimentum maecenas condimentum sapien vitae ipsum lacinia tempor aliquet risus vehicula phasellus volutpat leo a magna tincidunt a tempor sem varius donec sed laoreet ex cras nec dictum dui donec ac enim rutrum bibendum eros sit amet varius leo lorem ipsum dolor sit amet consectetur adipiscing elit sed faucibus ex at blandit elementum suspendisse semper justo quis pharetra mattis urna lorem tincidunt odio at efficitur erat urna eget odio praesent elementum id sem ac auctor nullam pulvinar dui nec mattis tristique aliquam viverra suscipit faucibus mauris in mauris eget ex porttitor eleifend ut at justo vestibulum accumsan arcu vel congue ornare quisque purus nisi facilisis lobortis accumsan a convallis non tortor sed mi odio fringilla facilisis nulla vel facilisis elementum arcu proin placerat placerat eros tincidunt ornare aenean non sem lacus aliquam erat volutpat morbi condimentum diam imperdiet risus ultrices dignissim sed non risus ut placerat accumsan lorem nec pretium aenean ipsum massa auctor sollicitudin ex in vehicula congue turpis maecenas eu porta nunc morbi laoreet ex rutrum placerat orci sit amet placerat ante vivamus interdum eros vitae vulputate tristique in hac habitasse platea dictumst nunc at massa sem integer sit amet lorem sed dolor feugiat malesuada fusce ante risus dignissim at congue sed posuere a metus quisque dignissim enim nec enim convallis iaculis vestibulum feugiat mi vitae placerat vulputate lacus tellus ullamcorper tellus at luctus risus sapien in metus curabitur vitae consequat neque curabitur arcu ante viverra vitae erat at pulvinar facilisis ex morbi volutpat tempus augue curabitur massa tortor venenatis ut dignissim sed dignissim ac sem fusce condimentum est quis tortor molestie ut fringilla tortor molestie aenean pretium lorem ut massa tempor id tincidunt risus varius aenean hendrerit vehicula arcu sit amet volutpat nibh consequat ut duis sollicitudin consequat fringilla nulla ullamcorper nec nibh vel convallis sed sollicitudin nulla a quam interdum ut semper elit mattis vestibulum at nisl at nisl accumsan fermentum aliquam condimentum justo eget nunc pellentesque auctor nam in scelerisque mi sit amet elementum ipsum etiam vel faucibus orci aenean molestie tristique velit nam suscipit eleifend purus pharetra pulvinar nulla vel maximus leo integer congue massa leo sollicitudin fringilla diam consectetur a suspendisse fermentum justo eget aliquam luctus nullam et urna at augue pharetra luctus sed quis blandit orci etiam auctor eros felis quis aliquam orci tincidunt et fusce et purus velit proin convallis eu ligula sed aliquet nunc imperdiet mi dictum porttitor tincidunt turpis eros laoreet risus eu viverra turpis augue sed turpis suspendisse eget orci et magna consequat venenatis non a urna vestibulum non libero accumsan ornare mi a dignissim odio orci varius natoque penatibus et magnis dis parturient montes nascetur ridiculus mus vivamus ut eros quis nulla dignissim egestas sed ac dolor quisque consequat nulla sed enim congue ac tristique orci tristique in hac habitasse platea dictumst etiam vel massa blandit feugiat lorem tempor rutrum tellus aenean eu felis tincidunt auctor nisi quis condimentum nunc duis at hendrerit eros in dapibus libero turpis et venenatis enim rutrum a pellentesque quis euismod quam aliquam varius lectus eu vehicula eleifend neque ante eleifend metus ut mollis ante lorem at ipsum praesent lorem nulla fermentum eleifend facilisis in accumsan sed lectus suspendisse potenti quisque at arcu vehicula rhoncus ante vitae elementum libero nam at tellus eget mauris tempus sodales eget vel lorem vivamus dapibus varius eros et dapibus felis pharetra quis sed felis lectus eleifend vitae felis at pulvinar scelerisque elit maecenas egestas commodo tellus vitae efficitur lorem vehicula ac nam consectetur commodo ante ac molestie ligula laoreet non praesent pulvinar odio non consequat ornare arcu orci dictum diam ut consectetur purus urna sed mauris aliquam porta imperdiet velit ut rhoncus nisl fringilla nec vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae aliquam nec efficitur arcu mollis pellentesque massa nulla metus metus posuere non faucibus eget faucibus sit amet neque ut porta mauris quis libero sodales ut imperdiet ligula consectetur donec porta erat ultricies urna rutrum malesuada in pulvinar dictum tellus id sagittis ex congue at vivamus volutpat dolor ac velit gravida porta commodo magna facilisis lorem ipsum dolor sit amet consectetur adipiscing elit nunc quis diam imperdiet dapibus sapien sit amet volutpat nibh curabitur egestas non turpis dignissim lacinia vestibulum et velit est suspendisse scelerisque est at gravida varius nulla dui ornare nisi id molestie mi ipsum ut purus pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas nunc ut ex vel eros maximus mollis curabitur ut suscipit dolor maecenas vehicula aliquam nunc consectetur molestie lacus ultrices at donec malesuada suscipit lectus eget tempor diam dictum sed ut eleifend non odio non commodo praesent sit amet elit metus duis tempus pellentesque risus vitae placerat phasellus egestas justo non purus sagittis eleifend nullam sed pellentesque quam sed interdum lorem fusce posuere enim quis maximus volutpat sed vel ipsum sit amet nunc dapibus volutpat eu a nisi vestibulum id nunc ipsum suspendisse potenti suspendisse vehicula bibendum massa vitae consectetur";

let closeAfter: boolean = false;
let addPunctuation: boolean = false;

figma.showUI(__html__, {
  themeColors: true,
  width: 320,
  height: 220,
  title: "Lorem Ipsum Range Generator",
});

const defaultFontName: FontName = {
  family: "Inter",
  style: "Regular",
};

function isSingleFontName(
  fontName: FontName | PluginAPI["mixed"]
): fontName is FontName {
  return (fontName as FontName).family != null;
}

figma.ui.onmessage = (msg: {
  type: string;
  inValue: string;
  closeAfter: boolean;
  addPunctuation: boolean;
}) => {
  if (msg.type === "update-closeAfter") {
    closeAfter = msg.closeAfter;
  }
  if (msg.type === "update-addPunctuation") {
    addPunctuation = msg.addPunctuation;
  }
  if (msg.type === "replace-text") {
    async function loadFonts(
      params: FontName = defaultFontName
    ): Promise<void> {
      await figma.loadFontAsync(params);
    }

    async function handleFontsAndProcessText(msg: {
      type: string;
      inValue: string;
    }): Promise<void> {
      await loadFonts();
      const range = parseInput(msg.inValue);

      if (figma.currentPage.selection.length === 0) {
        figma.notify("Please select a text node", { timeout: 2000 });
        return;
      }

      for (const selection of figma.currentPage.selection) {
        if (selection.type !== "TEXT") {
          figma.notify("Skipping selections that aren't text", {
            timeout: 1000,
          });
          continue;
        }

        if (!isSingleFontName(selection.fontName)) {
          figma.notify(
            "Mixed text styles aren't supported. Select text with only one font and style.",
            { timeout: 2500 }
          );
          continue;
        }

        await loadFonts(selection.fontName);
        selection.characters = processText(processString(inputString, range));
        selection.textAutoResize = "WIDTH_AND_HEIGHT";
      }

      if (closeAfter) {
        figma.closePlugin();
      }
    }

    handleFontsAndProcessText(msg);
  }
};

let numberOfWords: number = 0;

function parseInput(value: string) {
  const splitInput: string[] = value.trim().split("-");
  const isRange: boolean = splitInput.length > 1;
  if (isRange) {
    return {
      min: parseInt(splitInput[0], 10),
      max: parseInt(splitInput[1], 10),
    };
  } else {
    const value: number = parseInt(splitInput[0], 10);
    return { min: value, max: value };
  }
}

function processString(
  str: string,
  count: { min: number; max: number }
): string {
  const wordsArray: string[] = str.trim().toLowerCase().split(/\s+/);
  const uniqueWords: string[] = [...new Set(wordsArray)];
  const newString: string[] = [];
  const howManyWords: number =
    count.min === count.max
      ? count.max
      : Math.floor(Math.random() * (count.max - count.min + 1) + count.min);
  for (let i = 0; i < howManyWords; i++) {
    const randomIndex: number = Math.floor(Math.random() * uniqueWords.length);
    newString.push(uniqueWords[randomIndex]);
  }
  let output: string = newString.join(" ");
  return output;
}

function getRandom<T>(array: T[]): T {
  const randomIndex = Math.floor(Math.random() * array.length);
  return array[randomIndex];
}

function processText(result: string): string {
  result = result.charAt(0).toUpperCase() + result.slice(1);
  const lineEndPunctuation: string[] = [".", ".", ".", ".", ".", ".", "!", "?"];
  const inlinePunctuation: string[] = [",", ",", ",", "."];
  if (result.charAt(result.length - 1) !== "." && addPunctuation) {
    result += getRandom(lineEndPunctuation); // Add a period at the end if not already present
  }
  const words: string[] = result.split(" ");
  const numberOfPeriods: number = Math.floor(words.length / 7); // Decide on number of periods to insert

  for (let i = 0; i < numberOfPeriods; i++) {
    const randomIndex: number =
      Math.floor(Math.random() * (words.length - 2)) + 1; // Random index, avoiding start and end
    const currChar: string = words[randomIndex].charAt(
      words[randomIndex].length - 1
    );
    if (/^[a-zA-Z]$/.test(currChar) && addPunctuation) {
      words[randomIndex] += getRandom(inlinePunctuation);
    }
    if (randomIndex + 1 < words.length && addPunctuation) {
      if (words[randomIndex].endsWith(".")) {
        words[randomIndex + 1] =
          words[randomIndex + 1].charAt(0).toUpperCase() +
          words[randomIndex + 1].slice(1);
      }
    }
  }
  return words.join(" ");
}
